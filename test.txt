@[TOC](计算机网络总结)

# 总结
## 第一章 计算机网络概述
局域网：
	覆盖范围小 自己花钱买 带宽固定
广域网：
	距离远 花钱买服务
Internet ISP：
 	自己的机房 对网民提供连接
接入层交换机 汇聚层交换机（带宽多）星型结构 分层
运营商机房 双线机房

计算机数据通信的过程：
客户端发送请求到服务器的过程
	IP地址 公网地址 网络部分 主机部分 子网掩码 网关（去哪转） ipconfig
	48位2进制物理地址
	网站解析到ip地址 DNS服务器
	数据内容 自己地址 目标地址 自己物理地址 路由器物理地址
	数据包                                数据帧
	据帧 物理地址重写 选哪个路近
	地址和物理地址作用
服务器传到客户端
切成小包编号后发出去 压缩加密？缓存 确认 缓存中读出来配凑成一个

OSI参考模型
应用层 所有能产生网络流量的程序
表示层 在传输之前中是否加密 压缩处理 二进制、ASCII 开发人员处理 乱码？
会话层  （netstat -n 查看会话） 查看木马 netstat -nb  /? 查指令
传输层 可靠传输 流量控制 不可靠传输
网络层 选择最佳路径 规划IP地址
数据连接层 帧的开始结束 透明传输 差错效验                             交换机
物理层 借口标准 电器标准 如何在物理连接传输更快
	相互之间不能重叠，例如物理地址用了ip 再加个地址
	以前的光纤不支持
	连了代理服务器 netstat -n
拍错指导
物理层故障 查看网卡状态 数据包 网线没有接上 已发送与已接收 线没接好
数据层故障 mac地址冲突 注册表 ADSL欠费 网速没办法协商 计算机连到错误的Vlan
网路层故障 配置错误的ip地址 子网掩码 网关 路由器没有配置到达目标地址的网络
应用层故障 应用程序配置错误

ping ip

OSI参考模型和网络安全
1、物理层安全
2、数据层安全 ADSL 账号密码 VLAN 交换机端口绑定MAC地址
3、网络层安全 在路由器上使用ACL控制数据包流量 防火墙
4、应用层安全 没有漏洞

TCP、IP协议栈                                         5层模型
http ftp DNS
tcp udp
ARP IP     ICMP IGMP
ethernet    ATM     Frame Relay

封装与解析                                                         FCS 差错效验

应用层                                              上层数据
传输层                                  TCP头 +上层数据                数据段或消息
网络层                           IP头+TCP头+上层数据               数据包
数据链接层        MAC头+IP头+TCP头+上层数据 +FCS     数据帧
物理层                                          二进制                        bit流

计算机网络性能
1、速率 数据信道上传输上传数据位数的速率
bit rate data rate
b/s   Gb/s
2、带宽 最高数据率
字节
b/s
3、吞吐量 在单位时间内通过某个网络的数据量      总的流量
4、时延
发送时延 = 数据块长度除以信道带宽    带宽改的是发送时延    光纤是传播时延 光纤支持更高的带宽
传播时延 处理时延 排队时延
5、时延带宽积
线路上数据
6、RTT 往返时间
ping 网关                 1ms
ping 百度
ipconfig netstat ping
7、网路利用率
信道利用率 网络利用率
D = D。/(1-U)



## 第二章 物理层
2.1 基本概念
传输比特流
确定传输媒体接口的一些特性 机械 电气 功能 过程（规程）

2.2 数据通信的基础知识
数据通信模型 相关术语 信道 基带带通 调制方法 编码 信道极限容量 
奈式准则 码元传输有上限
香农公式 有信号干扰无差错传输的速率

数字比特流 +5V -5V 
调制解调器  发送、接受器
模拟信号
数据
信号
码元 二进制码元 1码元携带nbit信息量
信道 单向通信 双向交替通信（半双工通信） 双向同时通信
基带信号 带通信号
调幅 调频 调相
常见编码  单极性不归零码 双极性不归零码 单极性归零码 双极性归零码
               曼特斯特编码 差分曼切斯特编码
信道极限容量
	有干扰 失真 奈式准则 上限 光纤
信噪比 C=Wlog2（1+S/N） 传播速率 香农公式

2.3 传输媒体
有/屏蔽双绞线 同轴电缆
网线 8根线 1 3 2 6 两台计算机交叉线 直通线连交换机
13 26 31 62
网卡现在设备自动协商
光纤 全反射 多模光纤 单模光纤 有线电视单模
非导向 无线电离层 微波地面微波通讯
物理层设备 集线器hub冲突域 交换机

2.4 信道复用技术
频分复用 分用 例子：打电话
时分复用 
统计时分复用
波分复用

2.5 数字传输系统
E1 T1 脉码调制PCM

2.6 宽带接入技术
ADSL 电话线 dmt技术 不对称 上行下行 ATU-C ATU-R
HFC 有线电视 很宽的频带
光纤到家



## 第三章 数据链路层
1、基本概念
 2、两种情况下
3、以太网

信道类型 点到点 广播
链路 物理上的线
数据链路 除物理线外，传数据了
                帧 帧头 帧尾 物理层地址 校验值
三个基本问题
	封装成帧   1B ESC 透明传输
	透明传输
	差错控制    循环冗余检验 CRC FCS帧检验序列
两种情况   广域网 PPP协议（点对点） 链路控制协议 身份验证LCP
	广播信道的 局域网 静态划分信道 动态媒体接入控制 随机接入 载波监听
	所以只能半双工 时延 争用期 10M64字节 640字节 100米
                二进制指数类型退避算法 
	载波监听多路访问CSMA/CD
以太网 LLC MAC 现在只有MAC
信道利用率 a
MAC层  帧格式 9.6微秒的间隔
扩展以太网        距离扩展 光纤
	        数量扩展 大的冲突域 效率减低
优化以太网        网桥  变成交换机 存储传输 全双工 独享带宽 可学习MAC 防止抓包
百兆以太网 CSMA/CD不适用 
1G以太网   宽带接入



## 第四章 网络层
网络层提供的服务 负责尽力传数据包 不负责重传、顺序
互联网 物理层、数据链路层比较复杂，网络层 路由器工作上网络层，三层设备
路由器 配置路由表
网络设备和OSI参考模型 
               准备阶段
应用层                                                                                                                                                   应用层
表示层                                                                                                                
会话层                                                                                                                                                                                      
传输层     1    2                                                                                                                                      传输层
网络层      1 ip1  ip2                                         路由                         路由                                                网络层
连接层       pcs 1 ip1 ip2 m1 m2           交换机            1 ip1 ip2 FF          1 ip1 ip3 m1 m2                         连接层
物理层        比特流                    集线器                                                                                                    物理层

应用层数据包 传输层分段编号 网络层加IP地址 数据链路层加MAC地址
分两种情况 子网掩码判断同一路段？ARP解析广播MAC
 	  如果不是一个网段，给路由器 网关跨网通信
集线器 增强信号 比特流的流动
交换机 存储转发 数据帧的流动
路由器 数据包流动 能不能中病毒？不能 病毒是应用程序 能影响堵塞

ARP协议 网关ARP 为ip服务 路由器隔绝
ARP 将IP地址通过广播 解析目标IP地址的MAC地址
ARP欺骗 一个网段欺骗 欺骗网关 arp -a arp -s
ip             数据包转发数据 选择路径
ICMP协议 ping time TTL（防止循坏）linux64 windows128 unix255
                ping -t ping -l ping -i 8.8.8.8 网络层通 域名解析问题
                ping 估算网络畅通
	pathping 跟踪路径 计算丢包率 tracert traceroute
	请求超时或目标不可到达
IGMP协议 点到点 可以调整时间
	广播   FF 255 全网广播 
	组播多播 多播IP地址 跨网段 不建立会话
	路由器上 
IP数据包   首部20字节+数据部分
	版本 
	区分服务 QoS
	       	连接层1500 网络层65335字节 分片 
		数据包如果不分片最大1480字节
	       	数据包分片了 泪滴攻击
	标识 分片一样
	标志 是否分片
	偏移量 分片信息
	生存时间 TTL time to live 环路
	协议号 ICMP 1 IGMP 2 TCP 6 UDP 17 IPv6 41 OSPF 89  16进制
	首部检验和 反码算术
	可选字段 + 填充0000 ipv6没有
抓包工具   广播包 多播包 二分拔网线 打印机问题？
IP协议      RIP协议 OSPF 自动学习路由表的都是ip协议
	数据包有去有回 有没有网关 路由表 MAC
静态路由   需要管理员告诉路由器所有没有直连的网络下一跳给谁
动态路由   RIP 周期性广播路由表 跳数 30秒更新下一个路由信息 最大跳数16跳 rip



## 第五章 传输层
应用
TCP      一个数据包传输需要文件分段 建立会话 可靠传输 流量控制
UDP     一个数据包就能完成数据通信 不需要建立会话 不需要流量控制 不可靠传输
            多播或者广播 网游
传输层与应用层关系
	http   tcp+80
	https tcp+443
	RDP   tcp+3389
	ftp     tcp+21
	共享文件夹 tcp+445
	SMTP  tcp+25
	pop3 tcp+110
	telnet tcp+23
	SQL tcp+1433
	DNS UDP+53
服务和应用协议之间的关系
	web  tcp80
	ftp    tcp21
	smtp tcp25
	pop3 tcp110
  服务使用tcp端口侦听客户请求
  客户端使用IP地址定位到服务器 使用目标端口 定位服务
  可以关闭不用端口 实现服务器网络安全
如何安装服务 查看侦听端口 更改服务器使用的默认端口 设置网络安全
传输层功能 为应用程序提供了逻辑通讯
	区别网络层： 提供主机之间的通讯
tcp面向连接 udp无连接
网络层用协议号标识 tcp 6 udp17
端口本地唯一 不应该冲突 0-65535
	0-1023 
     	登记端口 rdp 3389
	客户端端口
UDP的主要特点 	无连接 
		最大尽力交付，不保证交付，不使用拥塞控制
		面向报文，没有拥塞控制，适用于多媒体通信
		支持一对一，一对多，多对多交互通信、
		首部开销小，8字节
伪首部12 + 8字节UDP（源端口 目标端口 长度 检验和）
TCP协议		面向连接
		一对一
		可靠交付，流量控制（收发同一流量），拥塞控制（网络堵，不是计算机问题）
		全双工通信
		面向字节流传输
如何可靠传输
如何流量控制
如何避免堵塞

tcp连接端口 套接字socket（插座）

可靠传输		停止等待协议 等一个RTT时间 超时重传 信道利用率低
		确认丢失 确认迟到
ARQ 重传不发请求 没收到就重发
	流水线传输： ACK 发送窗口 累计确认

报文段 20字节+可选
源端口2 目的端口2
序号4（标志 数据段是整个的第几个字节）
确认号4（标志 该发哪个缓存）
数据偏移+保留+urg（不排队传输）+ack（确认号有没有效）+psh（不排队提交）+rst（重启）+syh（同步？请求会话）+fin（释放连接）+窗口 设置接受缓存 设置缓存 再回传
检验和+紧急指针
选项（长度可变）+填充

xp                 确认号 ack0 syn1                               web
                               ack1 syn1
	                ack1 syn0
	
如何实现可靠传输 停止等待协议 窗口 累计确认 选择性确认
超时重传时间的选择 rtt 计时器 新旧rrt加权平均
